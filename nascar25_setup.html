<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NASCAR 25 Setup Generator</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; background:#f5f5f5; }
h1 { text-align:center; }
label { display:block; margin-top:10px; }
select, input[type=range] { width: 100%; margin-top:5px; }
button { margin-top: 20px; width:100%; padding:10px; background:#007bff; color:white; border:none; font-size:16px; border-radius:5px; }
pre { background:#e0e0e0; padding:10px; border-radius:5px; overflow-x:auto; }
</style>
</head>
<body>

<h1>NASCAR 25 Setup Generator</h1>

<label>Track:
<select id="track">
<option value="Charlotte">Charlotte</option>
<option value="Daytona">Daytona</option>
<option value="Atlanta">Atlanta</option>
</select>
</label>

<label>Driving Style:
<select id="style">
<option value="Aggressive">Aggressive</option>
<option value="Balanced">Balanced</option>
<option value="Smooth">Smooth</option>
</select>
</label>

<label>Input Type:
<select id="inputType">
<option value="Controller">Controller</option>
<option value="Wheel">Wheel</option>
</select>
</label>

<label>Loose ↔ Tight: <span id="looseTightValue">0</span></label>
<input type="range" id="looseTight" min="-1" max="1" step="0.1" value="0">

<label>Corner Entry:
<select id="cornerEntry">
<option value="Tight">Tight</option>
<option value="Neutral">Neutral</option>
<option value="Loose">Loose</option>
</select>
</label>

<label>Corner Mid:
<select id="cornerMid">
<option value="Tight">Tight</option>
<option value="Neutral">Neutral</option>
<option value="Loose">Loose</option>
</select>
</label>

<label>Corner Exit:
<select id="cornerExit">
<option value="Tight">Tight</option>
<option value="Neutral">Neutral</option>
<option value="Loose">Loose</option>
</select>
</label>

<button onclick="generateSetup()">Generate Setup</button>

<pre id="output"></pre>

<script>
// Master JSON data
const data = {
  CupSeries: {
    "Charlotte": {
      wedge:50, frontSprings:{LF:3300, RF:3300}, rearSprings:{LR:2100, RR:2775},
      tirePressure:{LF:22.5, RF:40, LR:22.5, RR:40}, swayBar:{Front:1.0, Rear:0.0},
      rearGear:3.76, brakeBias:58, camber:{Front:{LF:5, RF:-6}, Rear:{LR:2, RR:-2}},
      toe:{Front:0, Rear:0}, bump:{Front:{LF:3, RF:5}, Rear:{LR:7, RR:7}},
      rebound:{Front:{LF:8, RF:6}, Rear:{LR:7, RR:7}}, wheelLock:7.5,
      leftWeight:53, noseWeight:51, steeringOffset:0.01
    },
    "Daytona": {
      wedge:50, frontSprings:{LF:3300, RF:3300}, rearSprings:{LR:2100, RR:2775},
      tirePressure:{LF:22.5, RF:40, LR:22.5, RR:40}, swayBar:{Front:1.0, Rear:0.0},
      rearGear:3.76, brakeBias:58, camber:{Front:{LF:5, RF:-6}, Rear:{LR:2, RR:-2}},
      bump:{Front:{LF:3, RF:5}, Rear:{LR:7, RR:7}}, rebound:{Front:{LF:8, RF:6}, Rear:{LR:7, RR:7}},
      wheelLock:3.75, leftWeight:53, noseWeight:51, steeringOffset:0.07
    },
    "Atlanta": {
      wedge:50, frontSprings:{LF:0, RF:0}, rearSprings:{LR:0, RR:0},
      tirePressure:{LF:0, RF:0, LR:0, RR:0}, swayBar:{Front:0, Rear:0}, rearGear:0, brakeBias:0,
      camber:{Front:{LF:0, RF:0}, Rear:{LR:0, RR:0}}, bump:{Front:{LF:3, RF:5}, Rear:{LR:7, RR:7}},
      rebound:{Front:{LF:8, RF:6}, Rear:{LR:7, RR:7}}, wheelLock:5, leftWeight:0, noseWeight:0, steeringOffset:0
    }
  },
  drivingStyleModifiers:{
    "Aggressive": {frontSprings:1.05, rearSprings:1.05, wedge:2, tirePressure:{LF:0.5, RF:0.5, LR:0.5, RR:0.5}},
    "Balanced": {frontSprings:1.0, rearSprings:1.0, wedge:0, tirePressure:{LF:0, RF:0, LR:0, RR:0}},
    "Smooth": {frontSprings:0.95, rearSprings:0.95, wedge:-2, tirePressure:{LF:-0.5, RF:-0.5, LR:-0.5, RR:-0.5}}
  },
  inputTypeModifiers:{
    "Controller": {steeringOffset:0, wheelLock:0},
    "Wheel": {steeringOffset:-0.02, wheelLock:2}
  },
  looseTightSlider:{
    tight:{frontSprings:1.05, rearSprings:0.95, wedge:-1.5, rearRebound:1.05, leftWeight:0.5},
    neutral:{frontSprings:1.0, rearSprings:1.0, wedge:0, rearRebound:1.0, leftWeight:0},
    loose:{frontSprings:0.95, rearSprings:1.05, wedge:1.5, rearRebound:0.95, leftWeight:-0.5}
  },
  cornerBalanceModifiers:{
    Entry:{
      Tight:{frontSprings:1.05,rearSprings:0.95,wedge:-1,rearRebound:1.05},
      Neutral:{frontSprings:1,rearSprings:1,wedge:0,rearRebound:1},
      Loose:{frontSprings:0.95,rearSprings:1.05,wedge:1,rearRebound:0.95}
    },
    Mid:{
      Tight:{frontSprings:1.04,rearSprings:0.96,wedge:-0.5,rearRebound:1.03},
      Neutral:{frontSprings:1,rearSprings:1,wedge:0,rearRebound:1},
      Loose:{frontSprings:0.96,rearSprings:1.04,wedge:0.5,rearRebound:0.97}
    },
    Exit:{
      Tight:{frontSprings:1.03,rearSprings:0.97,wedge:-0.5,rearRebound:1.02},
      Neutral:{frontSprings:1,rearSprings:1,wedge:0,rearRebound:1},
      Loose:{frontSprings:0.97,rearSprings:1.03,wedge:0.5,rearRebound:0.98}
    }
  }
};

// Helper functions
function applyModifier(value, mod, type='mult'){
  if(typeof value==='object'){
    const res={};
    for(let k in value) res[k]=applyModifier(value[k], mod[k]!==undefined?mod[k]:1, type);
    return res;
  }
  return type==='mult'?value*mod:value+mod;
}

function interpolateLooseTight(value){
  if(value>=0){ // Neutral → Loose
    return {
      frontSprings: data.looseTightSlider.neutral.frontSprings + value*(data.looseTightSlider.loose.frontSprings - data.looseTightSlider.neutral.frontSprings),
      rearSprings: data.looseTightSlider.neutral.rearSprings + value*(data.looseTightSlider.loose.rearSprings - data.looseTightSlider.neutral.rearSprings),
      wedge: data.looseTightSlider.neutral.wedge + value*(data.looseTightSlider.loose.wedge - data.looseTightSlider.neutral.wedge),
      rearRebound: data.looseTightSlider.neutral.rearRebound + value*(data.looseTightSlider.loose.rearRebound - data.looseTightSlider.neutral.rearRebound),
      leftWeight: data.looseTightSlider.neutral.leftWeight + value*(data.looseTightSlider.loose.leftWeight - data.looseTightSlider.neutral.leftWeight)
    };
  }else{ // Tight → Neutral
    let v = -value;
    return {
      frontSprings: data.looseTightSlider.neutral.frontSprings + v*(data.looseTightSlider.tight.frontSprings - data.looseTightSlider.neutral.frontSprings),
      rearSprings: data.looseTightSlider.neutral.rearSprings + v*(data.looseTightSlider.tight.rearSprings - data.looseTightSlider.neutral.rearSprings),
      wedge: data.looseTightSlider.neutral.wedge + v*(data.looseTightSlider.tight.wedge - data.looseTightSlider.neutral.wedge),
      rearRebound: data.looseTightSlider.neutral.rearRebound + v*(data.looseTightSlider.tight.rearRebound - data.looseTightSlider.neutral.rearRebound),
      leftWeight: data.looseTightSlider.neutral.leftWeight + v*(data.looseTightSlider.tight.leftWeight - data.looseTightSlider.neutral.leftWeight)
    };
  }
}

document.getElementById('looseTight').addEventListener('input', e=>{
  document.getElementById('looseTightValue').innerText = e.target.value;
});

function generateSetup(){
  let track=document.getElementById('track').value;
  let style=document.getElementById('style').value;
  let inputType=document.getElementById('inputType').value;
  let looseTight=parseFloat(document.getElementById('looseTight').value);
  let cornerBalance={
    Entry: document.getElementById('cornerEntry').value,
    Mid: document.getElementById('cornerMid').value,
    Exit: document.getElementById('cornerExit').value
  };
  
  let setup=JSON.parse(JSON.stringify(data.CupSeries[track])); // deep copy
  
  // Driving style
  setup.frontSprings=applyModifier(setup.frontSprings, data.drivingStyleModifiers[style].frontSprings);
  setup.rearSprings=applyModifier(setup.rearSprings, data.drivingStyleModifiers[style].rearSprings);
  setup.wedge+=data.drivingStyleModifiers[style].wedge;
  setup.tirePressure=applyModifier(setup.tirePressure, data.drivingStyleModifiers[style].tirePressure, 'add');
  
  // Input type
  setup.steeringOffset+=data.inputTypeModifiers[inputType].steeringOffset;
  setup.wheelLock+=data.inputTypeModifiers[inputType].wheelLock;
  
  // Loose/Tight slider
  let looseMods=interpolateLooseTight(looseTight);
  setup.frontSprings=applyModifier(setup.frontSprings, looseMods.frontSprings);
  setup.rearSprings=applyModifier(setup.rearSprings, looseMods.rearSprings);
  setup.wedge+=looseMods.wedge;
  setup.rebound.Rear=applyModifier(setup.rebound.Rear, looseMods.rearRebound);
  setup.leftWeight+=looseMods.leftWeight;
  
  // Corner balance
  for(let phase in cornerBalance){
    let cb=data.cornerBalanceModifiers[phase][cornerBalance[phase]];
    setup.frontSprings=applyModifier(setup.frontSprings, cb.frontSprings);
    setup.rearSprings=applyModifier(setup.rearSprings, cb.rearSprings);
    setup.wedge+=cb.wedge;
    setup.rebound.Rear=applyModifier(setup.rebound.Rear, cb.rearRebound);
  }
  
  document.getElementById('output').innerText=JSON.stringify(setup,null,2);
}
</script>

</body>
</html>
